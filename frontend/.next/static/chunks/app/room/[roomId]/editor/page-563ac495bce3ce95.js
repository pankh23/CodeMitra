(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[554],{6733:function(e,t,a){Promise.resolve().then(a.bind(a,5224))},5224:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ev}});var s=a(7821),r=a(8078),i=a(8504),n=a(7531),o=a(5597),l=a(201),c=a(5331);class d{transform(e,t){return e.timestamp<=t.timestamp?this.transformOperation(e,t):this.transformOperation(t,e)}transformOperation(e,t){let a={operations:[e],transformed:[]};switch(e.type){case"insert":a.transformed=this.transformInsert(e,t);break;case"delete":a.transformed=this.transformDelete(e,t);break;case"retain":a.transformed=this.transformRetain(e,t)}return a}transformInsert(e,t){if("insert"===t.type){var a,s;return e.position<t.position?[e]:e.position>t.position?[{...e,position:e.position+((null===(a=t.text)||void 0===a?void 0:a.length)||0)}]:e.timestamp<t.timestamp?[e]:[{...e,position:e.position+((null===(s=t.text)||void 0===s?void 0:s.length)||0)}]}return"delete"===t.type?e.position<t.position?[e]:e.position>t.position+(t.length||0)?[{...e,position:e.position-(t.length||0)}]:[{...e,position:t.position}]:e.position<=t.position?[e]:[{...e,position:e.position+(t.length||0)}]}transformDelete(e,t){if("insert"===t.type){var a,s;return e.position<t.position?[e]:e.position>t.position?[{...e,position:e.position+((null===(a=t.text)||void 0===a?void 0:a.length)||0)}]:[{...e,position:e.position,length:(e.length||0)+((null===(s=t.text)||void 0===s?void 0:s.length)||0)}]}if("delete"===t.type){if(e.position+(e.length||0)<=t.position)return[e];if(e.position>=t.position+(t.length||0))return[{...e,position:e.position-(t.length||0)}];{let a=Math.min(e.position,t.position),s=Math.max(e.position+(e.length||0),t.position+(t.length||0));return[{...e,position:a,length:s-a}]}}if(e.position+(e.length||0)<=t.position)return[e];if(e.position>=t.position+(t.length||0))return[{...e,position:e.position-(t.length||0)}];{let a=Math.min(e.length||0,t.position+(t.length||0)-e.position);return[{...e,length:(e.length||0)-a}]}}transformRetain(e,t){if("insert"===t.type){var a;return e.position<t.position?[e]:[{...e,position:e.position+((null===(a=t.text)||void 0===a?void 0:a.length)||0)}]}if("delete"===t.type){if(e.position+(e.length||0)<=t.position)return[e];if(e.position>=t.position+(t.length||0))return[{...e,position:e.position-(t.length||0)}];{let a=t.position-e.position,s=e.position+(e.length||0)-(t.position+(t.length||0)),r=[];return a>0&&r.push({...e,length:a}),s>0&&r.push({...e,position:t.position,length:s}),r}}if(e.position+(e.length||0)<=t.position)return[e];if(e.position>=t.position+(t.length||0))return[{...e,position:e.position-(t.length||0)}];{let a=Math.min(e.length||0,t.position+(t.length||0)-e.position);return[{...e,length:(e.length||0)-a}]}}applyOperations(e,t){let a=e,s=0;for(let e of[...t].sort((e,t)=>e.position-t.position)){let t=e.position+s;switch(e.type){case"insert":e.text&&(a=a.slice(0,t)+e.text+a.slice(t),s+=e.text.length);break;case"delete":e.length&&(a=a.slice(0,t)+a.slice(t+e.length),s-=e.length);break;case"retain":if(t+(e.length||0)>a.length)throw Error("Invalid retain operation: position out of bounds")}}return a}createOperation(e,t,a,s){let r=[],i=0,n=0;for(;i<e.length||n<t.length;)if(i<e.length&&n<t.length&&e[i]===t[n]){let o=0;for(;i<e.length&&n<t.length&&e[i]===t[n];)o++,i++,n++;o>0&&r.push({type:"retain",position:i-o,length:o,userId:a,timestamp:s})}else n<t.length?(r.push({type:"insert",position:i,text:t[n],userId:a,timestamp:s}),n++):i<e.length&&(r.push({type:"delete",position:i,length:1,userId:a,timestamp:s}),i++);return r}getVersion(){return this.version}incrementVersion(){this.version++}constructor(){this.version=0,this.pendingOperations=[]}}let u=new d;var m=a(6028);function h(e){let{roomId:t,initialCode:a="",language:i="javascript",readOnly:d=!1,onCodeChange:h}=e,g=(0,r.useRef)(null),x=(0,r.useRef)(null),{user:p}=(0,n.aC)(),{code:f,cursors:y,handleCodeChange:b,updateCursorPosition:v}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"javascript",{socket:s,isConnected:i}=(0,c.s)(),{user:l}=(0,n.aC)(),{currentRoom:d}=(0,o.N)(),[m,h]=(0,r.useState)(t),[g,x]=(0,r.useState)(a),[p,f]=(0,r.useState)([]),[y,b]=(0,r.useState)(!1),[v,D]=(0,r.useState)(Date.now()),[j,N]=(0,r.useState)([]),[w,C]=(0,r.useState)(0),k=(0,r.useRef)(t),E=(0,r.useRef)();(0,r.useRef)([]);let S=(0,r.useCallback)(e=>{E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{I(e)},300)},[]),I=(0,r.useCallback)(async e=>{if(!s||!i||!l||!d)return;let t=k.current;if(t===e)return;let a=[];try{b(!0);let r=u.createOperation(t,e,l.id,Date.now());for(let e of(a=r,j))a=u.transform(r[0],e).transformed;s.emit("codeChange",{roomId:d.id,operations:a,version:w,userId:l.id,timestamp:Date.now()}),C(e=>e+1),D(Date.now()),k.current=e,N([])}catch(e){console.error("Failed to sync code changes:",e),a.length>0&&N(e=>[...e,...a])}finally{b(!1)}},[s,i,l,d,j,w]),z=(0,r.useCallback)(e=>{h(e),S(e)},[S]),T=(0,r.useCallback)(e=>{x(e),s&&i&&d&&s.emit("languageChange",{roomId:d.id,language:e,userId:null==l?void 0:l.id,timestamp:Date.now()})},[s,i,d,null==l?void 0:l.id]),R=(0,r.useCallback)((e,t)=>{if(!s||!i||!l||!d)return;let a={userId:l.id,userName:l.name||"Anonymous",userColor:A(l.id),position:e,selection:t};s.emit("cursorUpdate",{roomId:d.id,cursor:a,timestamp:Date.now()})},[s,i,l,d]),A=(0,r.useCallback)(e=>{let t=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F","#BB8FCE","#85C1E9","#F8C471","#82E0AA"],a=e.split("").reduce((e,t)=>e+t.charCodeAt(0),0)%t.length;return t[a]},[]);return(0,r.useEffect)(()=>{if(!s)return;let e=e=>{if(e.userId!==(null==l?void 0:l.id))try{let t=u.applyOperations(m,e.operations);h(t),k.current=t,C(e.version),N(t=>[...t,...e.operations])}catch(e){console.error("Failed to apply remote code changes:",e),s.emit("requestSync",{roomId:null==d?void 0:d.id,userId:null==l?void 0:l.id})}},t=e=>{e.userId!==(null==l?void 0:l.id)&&f(t=>t.find(t=>t.userId===e.userId)?t.map(t=>t.userId===e.userId?e.cursor:t):[...t,e.cursor])},a=e=>{e.userId!==(null==l?void 0:l.id)&&x(e.language)},r=e=>{e.userId!==(null==l?void 0:l.id)&&s.emit("codeSync",{roomId:e.roomId,code:m,language:g,version:w,userId:null==l?void 0:l.id,timestamp:Date.now()})},i=e=>{e.userId!==(null==l?void 0:l.id)&&(h(e.code),x(e.language),C(e.version),k.current=e.code,N([]))},n=e=>{f(t=>t.filter(t=>t.userId!==e.userId))},o=e=>{f(t=>t.filter(t=>t.userId!==e.userId))};return s.on("codeChange",e),s.on("cursorUpdate",t),s.on("languageChange",a),s.on("syncRequest",r),s.on("codeSync",i),s.on("userJoin",n),s.on("userLeave",o),()=>{s.off("codeChange",e),s.off("cursorUpdate",t),s.off("languageChange",a),s.off("syncRequest",r),s.off("codeSync",i),s.off("userJoin",n),s.off("userLeave",o)}},[s,null==l?void 0:l.id,m,g,w,null==d?void 0:d.id]),(0,r.useEffect)(()=>()=>{E.current&&clearTimeout(E.current)},[]),(0,r.useEffect)(()=>{s&&i&&d&&l&&(s.emit("joinRoom",{roomId:d.id,userId:l.id,userName:l.name}),s.emit("requestSync",{roomId:d.id,userId:l.id}))},[s,i,d,l]),{code:m,language:g,cursors:p,isConnected:i,isSyncing:y,lastSyncTime:v,version:w,handleCodeChange:z,handleLanguageChange:T,updateCursorPosition:R,getUserColor:A}}(t,a,i),[D,j]=(0,r.useState)(!0),{socket:N}=(0,c.s)();(0,r.useEffect)(()=>{if(!N||!p)return;let e=e=>{console.log("\uD83D\uDCDD Code update received from:",e.userName),e.userId!==p.id&&(b(e.code),e.language&&(console.log("\uD83C\uDF10 Language change received from:",e.userName),m.Am.success("Language changed to ".concat(e.language," by ").concat(e.userName))),m.Am.success("Code updated by ".concat(e.userName)))},t=e=>{console.log("\uD83C\uDF10 Language change received from:",e.userName),e.userId!==p.id&&(console.log("\uD83C\uDF10 Language change received from:",e.userName),m.Am.success("Language changed to ".concat(e.language," by ").concat(e.userName)))},a=e=>{e.userId!==p.id&&v({lineNumber:e.position.lineNumber,column:e.position.column})},s=()=>{console.log("\uD83D\uDC4B User left, clearing cursor positions")};return N.on("code:updated",e),N.on("code:language-changed",t),N.on("cursor-position",a),N.on("user-left",s),()=>{N.off("code:updated",e),N.off("code:language-changed",t),N.off("cursor-position",a),N.off("user-left",s)}},[N,p,b,v]);let w=(0,r.useCallback)((e,t)=>{if(g.current=e,x.current=t,j(!1),e.updateOptions({fontSize:14,minimap:{enabled:!0,side:"right",size:"proportional"},wordWrap:"off",readOnly:d,automaticLayout:!0,scrollBeyondLastLine:!1,renderLineHighlight:"all",cursorBlinking:"smooth",cursorSmoothCaretAnimation:"on",multiCursorModifier:"ctrlCmd",suggestOnTriggerCharacters:!0,quickSuggestions:!0,parameterHints:{enabled:!0},hover:{enabled:!0},contextmenu:!0,mouseWheelZoom:!0,lineNumbers:"on",roundedSelection:!1,formatOnPaste:!0,formatOnType:!0,bracketPairColorization:{enabled:!0},guides:{bracketPairs:!0,indentation:!0,highlightActiveIndentation:!0},renderValidationDecorations:"on",find:{addExtraSpaceOnTop:!1,autoFindInSelection:"never",caseSensitive:"off",findInSelection:!1,globalFindInSelection:!1,isRegex:!1,matchCase:!1,matchWholeWord:!1,regex:!1,searchScope:null,seedSearchStringFromSelection:"never",useGlobalFindInSelection:!1}}),N)return N.on("code-change",e=>{e.userId,null==p||p.id}),N.on("cursor-position",e=>{e.userId!==(null==p?void 0:p.id)&&v({lineNumber:e.position.lineNumber,column:e.position.column})}),N.on("user-left",()=>{}),N.on("language-change",e=>{e.userId,null==p||p.id}),()=>{N&&(N.off("code-change"),N.off("cursor-position"),N.off("user-left"),N.off("language-change"))}},[N,p,v,d]),C=(0,r.useCallback)(e=>{void 0!==e&&(b(e),null==h||h(e))},[b,h]);return(0,s.jsx)("div",{className:"flex flex-col h-full bg-gray-50 dark:bg-gray-900",children:(0,s.jsxs)("div",{className:"flex-1 relative overflow-hidden",children:[D&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 z-10",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-6 h-2 w-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Loading editor..."})]})}),(0,s.jsx)(l.ML,{height:"100%",language:i,theme:"vs-dark",value:f,onChange:C,onMount:w,options:{readOnly:d,fontSize:14,minimap:{enabled:!0,side:"right",size:"proportional"},wordWrap:"off",automaticLayout:!0,scrollBeyondLastLine:!1,renderLineHighlight:"all",cursorBlinking:"smooth",cursorSmoothCaretAnimation:"on",multiCursorModifier:"ctrlCmd",suggestOnTriggerCharacters:!0,quickSuggestions:!0,parameterHints:{enabled:!0},hover:{enabled:!0},contextmenu:!0,mouseWheelZoom:!0,lineNumbers:"on",roundedSelection:!1,formatOnPaste:!0,formatOnType:!0,bracketPairColorization:{enabled:!0},guides:{bracketPairs:!0,indentation:!0,highlightActiveIndentation:!0},renderValidationDecorations:"on",find:{addExtraSpaceOnTop:!1,autoFindInSelection:"never",caseSensitive:"off",findInSelection:!1,globalFindInSelection:!1,isRegex:!1,matchCase:!1,matchWholeWord:!1,regex:!1,searchScope:null,seedSearchStringFromSelection:"never",useGlobalFindInSelection:!1}}}),y.map(e=>(0,s.jsxs)("div",{className:"absolute z-30 pointer-events-none",style:{top:"".concat(20*e.position.lineNumber,"px"),left:"".concat(8*e.position.column,"px")},children:[(0,s.jsx)("div",{className:"w-0.5 h-5 animate-pulse",style:{backgroundColor:e.userColor}}),(0,s.jsx)("div",{className:"absolute top-0 left-1 px-2 py-1 text-xs text-white rounded whitespace-nowrap shadow-sm",style:{backgroundColor:e.userColor},children:e.userName}),e.selection&&(0,s.jsx)("div",{className:"absolute bg-opacity-20 rounded",style:{backgroundColor:e.userColor,top:"".concat(20*e.selection.startLineNumber,"px"),left:"".concat(8*e.selection.startColumn,"px"),width:"".concat((e.selection.endColumn-e.selection.startColumn)*8,"px"),height:"".concat((e.selection.endLineNumber-e.selection.startLineNumber+1)*20,"px")}})]},e.userId))]})})}var g=a(3842),x=a(5231),p=a(8006),f=a(5730),y=a(6515),b=a(6224),v=a(6400),D=a(2531),j=a(5813),N=a(1996),w=a(5867),C=a(8146),k=a(2592),E=a(7782),S=a(7198),I=a(7315),z=a(5818),T=a(3203),R=a(5407);class A{static getInstance(){return A.instance||(A.instance=new A),A.instance}async executeCode(e){let{code:t,language:a,input:s,roomId:r,userId:i}=e;if(!t.trim())return{success:!1,error:"Please write some code before executing.",status:"system_error",timestamp:new Date,language:a,codeSize:0};let n=new AbortController,o="".concat(r,"-").concat(i,"-").concat(Date.now());this.executionQueue.set(o,n);try{let e=await fetch("/api/code/execute",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({code:t.trim(),language:a,input:s||"",roomId:r,userId:i}),signal:n.signal});if(!e.ok)throw Error("Execution failed: ".concat(e.status," ").concat(e.statusText));let l=await e.json();return this.executionQueue.delete(o),{success:l.success,output:l.output,error:l.error,executionTime:l.executionTime,memoryUsed:l.memoryUsed,compilationTime:l.compilationTime,status:l.status,timestamp:new Date,language:a,codeSize:t.length}}catch(e){if(this.executionQueue.delete(o),e instanceof Error){if("AbortError"===e.name)return{success:!1,error:"Code execution was cancelled.",status:"system_error",timestamp:new Date,language:a,codeSize:t.length};return{success:!1,error:e.message,status:"system_error",timestamp:new Date,language:a,codeSize:t.length}}return{success:!1,error:"An unexpected error occurred during execution.",status:"system_error",timestamp:new Date,language:a,codeSize:t.length}}}cancelExecution(e){let t=this.executionQueue.get(e);return!!t&&(t.abort(),this.executionQueue.delete(e),!0)}cancelRoomExecutions(e){for(let[t,a]of Array.from(this.executionQueue.entries()))t.startsWith(e)&&(a.abort(),this.executionQueue.delete(t))}getExecutionStatus(e){return this.executionQueue.has(e)?{isExecuting:!0,progress:50,currentStep:"Executing code...",estimatedTime:5}:null}validateCodeSyntax(e,t){let a=[];if(!e.trim())return a.push("Code cannot be empty"),{isValid:!1,errors:a};switch(t){case"javascript":return this.validateJavaScript(e);case"typescript":return this.validateTypeScript(e);case"python":return this.validatePython(e);case"java":return this.validateJava(e);case"cpp":return this.validateCpp(e);case"c":return this.validateC(e);case"go":return this.validateGo(e);case"rust":return this.validateRust(e);case"php":return this.validatePhp(e);case"html":return this.validateHtml(e);case"css":return this.validateCss(e);case"sql":return this.validateSql(e);default:return{isValid:!0,errors:[]}}}validateJavaScript(e){let t=[];try{return Function(e),(e.includes("while(true)")||e.includes("for(;;)"))&&t.push("Potential infinite loop detected"),(e.includes("process.exit")||e.includes("window.close"))&&t.push("System exit commands are not allowed"),{isValid:0===t.length,errors:t}}catch(e){return{isValid:!1,errors:["JavaScript syntax error"]}}}validateTypeScript(e){return this.validateJavaScript(e)}validatePython(e){let t=[];return(e.includes("while True:")||e.includes("for i in range(9999999)"))&&t.push("Potential infinite loop detected"),(e.includes("os.system")||e.includes("subprocess.call"))&&t.push("System commands are not allowed"),(e.includes("import os")||e.includes("import subprocess"))&&t.push("System modules are not allowed"),{isValid:0===t.length,errors:t}}validateJava(e){let t=[];return e.includes("public class")||t.push("Java code must contain a public class"),e.includes("public static void main")||t.push("Java code must contain a main method"),(e.includes("System.exit")||e.includes("Runtime.getRuntime()"))&&t.push("System exit commands are not allowed"),{isValid:0===t.length,errors:t}}validateCpp(e){let t=[];return e.includes("int main()")||t.push("C++ code must contain a main function"),(e.includes("system(")||e.includes("exit("))&&t.push("System commands are not allowed"),{isValid:0===t.length,errors:t}}validateC(e){let t=[];return e.includes("int main(")||t.push("C code must contain a main function"),(e.includes("system(")||e.includes("exit("))&&t.push("System commands are not allowed"),{isValid:0===t.length,errors:t}}validateGo(e){let t=[];return e.includes("package main")||t.push("Go code must contain package main"),e.includes("func main()")||t.push("Go code must contain a main function"),(e.includes("os.Exit")||e.includes("syscall.Exec"))&&t.push("System exit commands are not allowed"),{isValid:0===t.length,errors:t}}validateRust(e){let t=[];return e.includes("fn main()")||t.push("Rust code must contain a main function"),(e.includes("std::process::exit")||e.includes("std::env::set_var"))&&t.push("System commands are not allowed"),{isValid:0===t.length,errors:t}}validatePhp(e){let t=[];return(e.includes("exec(")||e.includes("shell_exec(")||e.includes("system("))&&t.push("System commands are not allowed"),(e.includes("file_get_contents")||e.includes("fopen"))&&t.push("File operations are not allowed"),{isValid:0===t.length,errors:t}}validateHtml(e){let t=[];return e.includes("<html")&&e.includes("</html>")||t.push("HTML code must contain html tags"),e.includes("<body")&&e.includes("</body>")||t.push("HTML code must contain body tags"),{isValid:0===t.length,errors:t}}validateCss(e){let t=[];return e.includes("{")&&e.includes("}")||t.push("CSS code must contain style rules"),{isValid:0===t.length,errors:t}}validateSql(e){let t=[],a=e.toUpperCase();for(let e of["DROP","DELETE","UPDATE","INSERT","ALTER","CREATE"])a.includes(e)&&t.push("".concat(e," operations are not allowed in demo mode"));return{isValid:0===t.length,errors:t}}constructor(){this.executionQueue=new Map}}let L=A.getInstance();function Z(e){var t;let{code:a,language:i,roomId:l,onExecutionStart:c,onExecutionComplete:d}=e,{user:u}=(0,n.aC)(),{currentRoom:m}=(0,o.N)(),[h,A]=(0,r.useState)(!1),[Z,F]=(0,r.useState)(null),[O,U]=(0,r.useState)(null),[M,P]=(0,r.useState)(""),[B,V]=(0,r.useState)("output"),[_,J]=(0,r.useState)([]),[W,H]=(0,r.useState)(!1),q=[{id:"output",label:"Output",icon:f.Z},{id:"input",label:"Input",icon:y.Z},{id:"debug",label:"Debug",icon:b.Z},{id:"history",label:"History",icon:v.Z}],Q=new Set(["python","java","cpp"]).has(i),Y=(0,r.useCallback)(async()=>{if(u&&m&&a.trim()){A(!0),U({isExecuting:!0,progress:0,currentStep:"Validating code...",estimatedTime:5}),null==c||c();try{let e=L.validateCodeSyntax(a,i);if(!e.isValid){let t={success:!1,error:e.errors.join("\n"),status:"compilation_error",timestamp:new Date,language:i,codeSize:a.length};F(t),J(e=>[t,...e.slice(0,9)]),null==d||d(t);return}let t=await L.executeCode({code:a,language:i,input:M.trim(),roomId:l,userId:u.id});F(t),J(e=>[t,...e.slice(0,9)]),null==d||d(t),"success"===t.status?U({isExecuting:!1,progress:100,currentStep:"Execution completed successfully",estimatedTime:0}):U({isExecuting:!1,progress:100,currentStep:"Execution failed: ".concat(t.status),estimatedTime:0})}catch(t){let e={success:!1,error:t instanceof Error?t.message:"Execution failed",status:"system_error",timestamp:new Date,language:i,codeSize:a.length};F(e),J(t=>[e,...t.slice(0,9)]),null==d||d(e)}finally{A(!1),setTimeout(()=>U(null),3e3)}}},[a,i,M,l,u,m,c,d]),G=(0,r.useCallback)(()=>{m&&(L.cancelRoomExecutions(m.id),A(!1),U(null))},[m]),X=(0,r.useCallback)(()=>{F(null),J([])},[]),K=(0,r.useCallback)(()=>{(null==Z?void 0:Z.output)&&navigator.clipboard.writeText(Z.output)},[Z]),$=(0,r.useCallback)(()=>{if(null==Z?void 0:Z.output){let e=new Blob([Z.output],{type:"text/plain"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="output-".concat(i,".txt"),a.click(),URL.revokeObjectURL(t)}},[Z,i]),ee=e=>{switch(e){case"success":return(0,s.jsx)(D.Z,{className:"w-4 h-4 text-green-500"});case"compilation_error":return(0,s.jsx)(j.Z,{className:"w-4 h-4 text-red-500"});case"runtime_error":return(0,s.jsx)(b.Z,{className:"w-4 h-4 text-orange-500"});case"timeout":return(0,s.jsx)(N.Z,{className:"w-4 h-4 text-yellow-500"});case"memory_limit":return(0,s.jsx)(w.Z,{className:"w-4 h-4 text-purple-500"});default:return(0,s.jsx)(j.Z,{className:"w-4 h-4 text-gray-500"})}},et=e=>{switch(e){case"success":return"Execution Successful";case"compilation_error":return"Compilation Error";case"runtime_error":return"Runtime Error";case"timeout":return"Execution Timeout";case"memory_limit":return"Memory Limit Exceeded";default:return"System Error"}},ea=e=>e<1e3?"".concat(e,"ms"):"".concat((e/1e3).toFixed(2),"s");return(0,s.jsxs)(p.Zb,{className:"h-full flex flex-col",children:[(0,s.jsx)(p.Ol,{className:"pb-3",children:(0,s.jsxs)(p.ll,{className:"flex items-center justify-between text-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(f.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:"Code Execution"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)(g.z,{onClick:Y,disabled:h||!a.trim(),size:"lg",className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-semibold px-8 py-3 h-12 text-base shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 disabled:transform-none disabled:opacity-50",children:[h?(0,s.jsx)(C.Z,{className:"w-5 h-5 animate-spin mr-3"}):(0,s.jsx)(k.Z,{className:"w-5 h-5 mr-3"}),h?"Running...":"▶ Run Code"]}),h&&(0,s.jsxs)(g.z,{onClick:G,variant:"outline",size:"lg",className:"text-red-600 border-red-200 hover:bg-red-50 h-12 px-6",children:[(0,s.jsx)(E.Z,{className:"w-5 h-5 mr-2"}),"Stop"]})]})]})}),(0,s.jsxs)(p.aY,{className:"flex-1 flex flex-col space-y-4",children:[(0,s.jsx)(T.M,{children:O&&(0,s.jsxs)(R.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(C.Z,{className:"w-4 h-4 animate-spin text-blue-600"}),(0,s.jsx)("span",{className:"text-sm text-blue-800 dark:text-blue-200",children:O.currentStep})]}),O.estimatedTime&&O.estimatedTime>0&&(0,s.jsxs)("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:["~",O.estimatedTime,"s"]})]}),void 0!==O.progress&&(0,s.jsx)("div",{className:"mt-2 w-full bg-blue-200 dark:bg-blue-800 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(O.progress,"%")}})})]})}),Q&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Input (stdin)"}),(0,s.jsxs)(g.z,{variant:"ghost",size:"sm",onClick:()=>H(!W),className:"h-6 px-2 text-xs",children:[W?"Hide":"Show"," Input"]})]}),W&&(0,s.jsx)("textarea",{value:M,onChange:e=>P(e.target.value),placeholder:"Enter input for your program...",className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 font-mono text-sm resize-none",rows:3})]}),(0,s.jsx)("div",{className:"flex space-x-1 border-b border-gray-200 dark:border-gray-700",children:q.map(e=>(0,s.jsxs)("button",{onClick:()=>V(e.id),className:"px-3 py-2 text-sm font-medium rounded-t-md transition-colors flex items-center space-x-2 ".concat(B===e.id?"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400 border-b-2 border-blue-500":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"),children:[(0,s.jsx)(e.icon,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:e.label})]},e.id))}),(0,s.jsxs)("div",{className:"flex-1 overflow-hidden",children:["output"===B&&(0,s.jsx)("div",{className:"h-full flex flex-col",children:Z?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-t-lg border-b border-gray-200 dark:border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[ee(Z.status),(0,s.jsx)("span",{className:"text-sm font-medium px-2 py-1 rounded border ".concat((e=>{switch(e){case"success":return"border-green-200 bg-green-50 text-green-800 dark:border-green-800 dark:bg-green-900/20 dark:text-green-400";case"compilation_error":return"border-red-200 bg-red-50 text-red-800 dark:border-red-800 dark:bg-red-900/20 dark:text-red-400";case"runtime_error":return"border-orange-200 bg-orange-50 text-orange-800 dark:border-orange-800 dark:bg-orange-900/20 dark:text-orange-400";case"timeout":return"border-yellow-200 bg-yellow-50 text-yellow-800 dark:border-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400";case"memory_limit":return"border-purple-200 bg-purple-50 text-purple-800 dark:border-purple-800 dark:bg-purple-900/20 dark:text-purple-400";default:return"border-gray-200 bg-gray-50 text-gray-800 dark:border-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}})(Z.status)),children:et(Z.status)})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500 dark:text-gray-400",children:[Z.executionTime&&(0,s.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,s.jsx)(N.Z,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:ea(Z.executionTime)})]}),Z.memoryUsed&&(0,s.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,s.jsx)(w.Z,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:(t=Z.memoryUsed)<1024?"".concat(t," KB"):"".concat((t/1024).toFixed(2)," MB")})]}),Z.compilationTime&&(0,s.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,s.jsx)(S.Z,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:ea(Z.compilationTime)})]})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-auto p-3 bg-gray-900 text-green-400 font-mono text-sm",children:Z.success?(0,s.jsx)("pre",{className:"whitespace-pre-wrap",children:Z.output}):(0,s.jsx)("pre",{className:"whitespace-pre-wrap text-red-400",children:Z.error})}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-b-lg border-t border-gray-200 dark:border-gray-700",children:[(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsxs)(g.z,{onClick:X,variant:"outline",size:"sm",className:"h-8 px-3 text-xs",children:[(0,s.jsx)(v.Z,{className:"w-3 h-3 mr-1"}),"Clear"]})}),(0,s.jsx)("div",{className:"flex items-center space-x-2",children:Z.output&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(g.z,{onClick:K,variant:"outline",size:"sm",className:"h-8 px-3 text-xs",children:[(0,s.jsx)(I.Z,{className:"w-3 h-3 mr-1"}),"Copy"]}),(0,s.jsxs)(g.z,{onClick:$,variant:"outline",size:"sm",className:"h-8 px-3 text-xs",children:[(0,s.jsx)(z.Z,{className:"w-3 h-3 mr-1"}),"Download"]})]})})]})]}):(0,s.jsx)("div",{className:"h-full flex items-center justify-center text-gray-500 dark:text-gray-400",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(f.Z,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:"No output yet. Run your code to see results."})]})})}),"input"===B&&(0,s.jsx)("div",{className:"h-full p-3",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Standard Input (stdin)"}),(0,s.jsx)("textarea",{value:M,onChange:e=>P(e.target.value),placeholder:"Enter input that your program will read from stdin...",className:"w-full h-32 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 font-mono text-sm resize-none"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"This input will be provided to your program when it runs."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Command Line Arguments"}),(0,s.jsx)(x.I,{placeholder:"arg1 arg2 arg3",className:"font-mono text-sm"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Space-separated command line arguments."})]})]})}),"debug"===B&&(0,s.jsx)("div",{className:"h-full p-3",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Code Analysis"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Code Size"}),(0,s.jsxs)("span",{className:"text-sm font-medium",children:[a.length," characters"]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Language"}),(0,s.jsx)("span",{className:"text-sm font-medium capitalize",children:i})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Lines"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:a.split("\n").length})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Execution Settings"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Timeout"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"10 seconds"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Memory Limit"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"256 MB"})]})]})]})]})}),"history"===B&&(0,s.jsx)("div",{className:"h-full p-3",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Recent Executions"}),_.length>0?(0,s.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:_.map((e,t)=>{var a;return(0,s.jsxs)("div",{className:"p-3 rounded-lg border cursor-pointer transition-colors ".concat(e.success?"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-900/20":"border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-900/20"),onClick:()=>F(e),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[ee(e.status),(0,s.jsx)("span",{className:"text-sm font-medium",children:et(e.status)})]}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:e.timestamp.toLocaleTimeString()})]}),(0,s.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:e.output?e.output.substring(0,100)+"...":(null===(a=e.error)||void 0===a?void 0:a.substring(0,100))+"..."})]},t)})}):(0,s.jsxs)("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:[(0,s.jsx)(v.Z,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:"No execution history yet."})]})]})})]})]})]})}var F=a(6614),O=a(8149),U=a(6556),M=a(961),P=a(4713);function B(e){var t,a,i;let{onRunCode:l,isExecuting:c=!1,currentLanguage:d="javascript",onLeaveRoom:u}=e,{user:h,logout:x}=(0,n.aC)(),{currentRoom:p}=(0,o.N)(),[f,y]=(0,r.useState)(!1),[b,v]=(0,r.useState)(!1),D=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{D.current&&!D.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let j=async()=>{if(null==p?void 0:p.id)try{await navigator.clipboard.writeText(p.id),v(!0),m.ZP.success("Room ID copied to clipboard!"),setTimeout(()=>v(!1),2e3)}catch(e){m.ZP.error("Failed to copy room ID")}},N=(null==p?void 0:null===(t=p.users)||void 0===t?void 0:t.length)||0,w=(null==p?void 0:p.isPublic)||!1,C={javascript:{name:"JavaScript",icon:"⚡",color:"bg-yellow-500"},python:{name:"Python",icon:"\uD83D\uDC0D",color:"bg-green-500"},java:{name:"Java",icon:"☕",color:"bg-orange-500"},cpp:{name:"C++",icon:"⚙️",color:"bg-blue-500"}}[d]||{name:d,icon:"\uD83D\uDCDD",color:"bg-gray-500"};return(0,s.jsx)(R.E.header,{className:"navbar-fixed bg-gray-900 shadow-lg border-b border-gray-700 z-50 h-16",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center",children:(0,s.jsx)(F.Z,{className:"w-6 h-6 text-white"})}),(0,s.jsx)("span",{className:"text-xl font-bold text-white",children:"CodeMitra"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("h1",{className:"text-lg font-semibold text-white",children:(null==p?void 0:p.name)||"Loading Room..."}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-300",children:[w?"Public Room":"Private Room"," • ",N," users"]}),(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:["ID: ",(null==p?void 0:p.id)||"..."]}),(0,s.jsx)(g.z,{variant:"outline",size:"sm",onClick:j,className:"h-6 px-2 bg-gray-800 border-gray-600 text-white hover:bg-gray-700 hover:border-gray-500",children:b?(0,s.jsx)(O.Z,{className:"w-3 h-3"}):(0,s.jsx)(I.Z,{className:"w-3 h-3"})})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-1 bg-gray-800 rounded-lg border border-gray-600",children:[(0,s.jsx)("span",{className:"text-lg",children:C.icon}),(0,s.jsx)("span",{className:"text-sm font-medium text-white",children:C.name}),(0,s.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(C.color)})]})]}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)(g.z,{onClick:l,disabled:c,size:"lg",className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-semibold px-8 py-3 h-12 text-base shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 disabled:transform-none disabled:opacity-50",children:[c?(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-3"}):(0,s.jsx)(k.Z,{className:"w-5 h-5 mr-3"}),c?"Running...":"▶ RUN CODE"]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)(g.z,{variant:"outline",size:"sm",onClick:u,className:"bg-red-600 border-red-500 text-white hover:bg-red-700 hover:border-red-600",children:[(0,s.jsx)(U.Z,{className:"w-4 h-4 mr-2"}),"Leave Room"]}),(0,s.jsxs)("div",{className:"relative",ref:D,children:[(0,s.jsxs)(g.z,{variant:"outline",size:"sm",onClick:()=>y(!f),className:"bg-gray-800 border-gray-600 text-white hover:bg-gray-700 hover:border-gray-500",children:[(0,s.jsx)(M.Z,{className:"w-4 h-4 mr-2"}),(0,s.jsxs)("span",{children:[N," users"]}),(0,s.jsx)(P.Z,{className:"w-4 h-4 ml-2 transition-transform duration-200 ".concat(f?"rotate-180":"")})]}),(0,s.jsx)(T.M,{children:f&&(0,s.jsxs)(R.E.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute right-0 mt-2 w-64 bg-gray-800 border border-gray-600 rounded-lg shadow-xl z-50",children:[(0,s.jsx)("div",{className:"p-3 border-b border-gray-600",children:(0,s.jsx)("h3",{className:"text-sm font-medium text-white",children:"Connected Users"})}),(0,s.jsx)("div",{className:"max-h-48 overflow-y-auto",children:(null==p?void 0:p.users)&&p.users.length>0?p.users.map(e=>{var t;return(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-3 hover:bg-gray-700 transition-colors duration-150",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-sm font-medium text-white",children:(null===(t=e.user.name)||void 0===t?void 0:t.charAt(0).toUpperCase())||"U"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-white truncate",children:e.user.name||"Anonymous User"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 truncate",children:e.user.email||"No email"})]}),(0,s.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"})]},e.id)}):(0,s.jsx)("div",{className:"p-3 text-center text-gray-400",children:(0,s.jsx)("p",{className:"text-sm",children:"No users connected"})})}),h&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"border-t border-gray-600"}),(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-2 hover:bg-gray-700 rounded-md transition-colors duration-150",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-red-500 to-pink-600 rounded-full flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-sm font-medium text-white",children:(null===(a=h.name)||void 0===a?void 0:a.charAt(0).toUpperCase())||(null===(i=h.email)||void 0===i?void 0:i.charAt(0).toUpperCase())||"U"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-white truncate",children:h.name||"You"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 truncate",children:h.email||"No email"})]})]}),(0,s.jsxs)(g.z,{onClick:()=>{x(),y(!1)},variant:"outline",size:"sm",className:"w-full mt-2 bg-red-600 border-red-500 text-white hover:bg-red-700 hover:border-red-600",children:[(0,s.jsx)(U.Z,{className:"w-4 h-4 mr-2"}),"Logout"]})]})]})]})})]})]})]})})})}var V=a(1406),_=a(1397),J=a(5319),W=a(168);let H={editor:{width:70,height:60},output:{width:30,height:40},chat:{width:30,height:30},video:{width:30,height:30}};function q(e){let{children:t,onLayoutChange:a,initialLayout:i}=e,[n,o]=(0,r.useState)({...H,...i}),[l,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(null),[m,h]=(0,r.useState)({x:0,y:0}),x=(0,r.useRef)(null),p=(0,r.useCallback)(e=>{try{localStorage.setItem("codemitra-layout",JSON.stringify(e))}catch(e){console.warn("Failed to save layout to localStorage:",e)}},[]),f=(0,r.useCallback)(()=>{try{let e=localStorage.getItem("codemitra-layout");if(e){let t=JSON.parse(e);o(t),null==a||a(t)}}catch(e){console.warn("Failed to load layout from localStorage:",e)}},[a]),y=(0,r.useCallback)(()=>{o(H),null==a||a(H),p(H)},[a,p]),b=(0,r.useCallback)(()=>{let e={editor:{width:70,height:60},output:{width:30,height:40},chat:{width:30,height:30},video:{width:30,height:30}};o(e),null==a||a(e),p(e)},[a,p]),D=(0,r.useCallback)((e,t)=>{t.preventDefault(),c(!0),u(e),h({x:t.clientX,y:t.clientY})},[]),j=(0,r.useCallback)(e=>{if(!l||!x.current)return;let t=x.current.getBoundingClientRect(),a=e.clientX-m.x,s=e.clientY-m.y;if("horizontal"===d){let e=a/t.width*100;o(t=>{let a={...t},s=Math.max(15,Math.min(85,t.editor.width+e)),r=100-s;return a.editor.width=s,a.output.width=r,a.chat.width=r,a.video.width=r,a})}else if("vertical"===d){let e=s/t.height*100;o(t=>{let a={...t},s=Math.max(15,Math.min(85,t.editor.height+e)),r=(100-s)/(t.output.height+t.chat.height+t.video.height);return a.editor.height=s,a.output.height=t.output.height*r,a.chat.height=t.chat.height*r,a.video.height=t.video.height*r,a})}},[l,d,m]),N=(0,r.useCallback)(()=>{l&&(c(!1),u(null),p(n),null==a||a(n))},[l,n,p,a]);return(0,r.useCallback)((e,t)=>{if(!x.current)return;let a=t/x.current.getBoundingClientRect().height*100;o(t=>{let s={...t},r=100-t.editor.height,i=["output","chat","video"],n=i.map(e=>t[e].height);n.reduce((e,t)=>e+t,0);let o=i.indexOf(e),l=Math.max(15,Math.min(85,n[o]+a)),c=i.filter((e,t)=>t!==o),d=c.map(e=>t[e].height).reduce((e,t)=>e+t,0);if(d>0){let e=(r-l)/d;c.forEach(a=>{s[a].height=t[a].height*e})}return s[e].height=l,s})},[]),(0,r.useEffect)(()=>{if(l)return document.addEventListener("mousemove",j),document.addEventListener("mouseup",N),()=>{document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",N)}},[l,j,N]),(0,r.useEffect)(()=>{f()},[f]),(0,r.useEffect)(()=>{n!==H&&p(n)},[n,p]),(0,s.jsxs)("div",{ref:x,className:"h-full w-full bg-gray-900 relative overflow-hidden",style:{cursor:l?"horizontal"===d?"ew-resize":"ns-resize":"default"},children:[(0,s.jsxs)("div",{className:"absolute top-4 right-4 z-50 flex items-center space-x-2",children:[(0,s.jsx)(g.z,{variant:"outline",size:"sm",onClick:b,className:"bg-gray-800 border-gray-600 text-white hover:bg-gray-700",title:"Auto-fit Layout",children:(0,s.jsx)(V.Z,{className:"w-4 h-4"})}),(0,s.jsx)(g.z,{variant:"outline",size:"sm",onClick:y,className:"bg-gray-800 border-gray-600 text-white hover:bg-gray-700",title:"Reset to Default",children:(0,s.jsx)(v.Z,{className:"w-4 h-4"})}),(0,s.jsx)(g.z,{variant:"outline",size:"sm",onClick:()=>p(n),className:"bg-gray-800 border-gray-600 text-white hover:bg-gray-700",title:"Save Layout",children:(0,s.jsx)(_.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"h-full flex",children:[(0,s.jsx)("div",{className:"bg-gray-800 border-r border-gray-700 relative",style:{width:"".concat(n.editor.width,"%")},children:t.editor}),(0,s.jsx)("div",{className:"w-1 bg-gray-600 hover:bg-blue-500 cursor-ew-resize relative group",onMouseDown:e=>D("horizontal",e),children:(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)(J.Z,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-400 opacity-0 group-hover:opacity-100 transition-opacity"})})}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col",style:{width:"".concat(100-n.editor.width,"%")},children:[(0,s.jsx)("div",{className:"bg-gray-800 border-b border-gray-700 relative",style:{height:"".concat(n.output.height,"%")},children:t.output}),(0,s.jsx)("div",{className:"h-1 bg-gray-600 hover:bg-blue-500 cursor-ns-resize relative group",onMouseDown:e=>D("vertical",e),children:(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)(W.Z,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-400 opacity-0 group-hover:opacity-100 transition-opacity"})})}),(0,s.jsx)("div",{className:"bg-gray-800 border-b border-gray-700 relative",style:{height:"".concat(n.chat.height,"%")},children:t.chat}),(0,s.jsx)("div",{className:"h-1 bg-gray-600 hover:bg-blue-500 cursor-ns-resize relative group",onMouseDown:e=>D("vertical",e),children:(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)(W.Z,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-400 opacity-0 group-hover:opacity-100 transition-opacity"})})}),(0,s.jsx)("div",{className:"bg-gray-800 flex-1 relative",style:{height:"".concat(n.video.height,"%")},children:t.video})]})]}),l&&(0,s.jsx)(R.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-20 z-40 pointer-events-none"})]})}var Q=a(8002),Y=a(6752),G=a(4159),X=a(469),K=a(8575),$=a(9775);let ee=[{id:"coding-focus",name:"Coding Focus",description:"Maximize editor space for intensive coding",icon:(0,s.jsx)(F.Z,{className:"w-4 h-4"}),layout:{editor:{width:80,height:70},output:{width:20,height:50},chat:{width:20,height:25},video:{width:20,height:25}},category:"workflow"},{id:"debugging",name:"Debugging",description:"Large output panel for debugging and logs",icon:(0,s.jsx)(f.Z,{className:"w-4 h-4"}),layout:{editor:{width:65,height:60},output:{width:35,height:60},chat:{width:35,height:20},video:{width:35,height:20}},category:"workflow"},{id:"collaboration",name:"Collaboration",description:"Balanced layout for team coding",icon:(0,s.jsx)(Q.Z,{className:"w-4 h-4"}),layout:{editor:{width:70,height:60},output:{width:30,height:40},chat:{width:30,height:30},video:{width:30,height:30}},category:"workflow"},{id:"presentation",name:"Presentation",description:"Large video panel for screen sharing",icon:(0,s.jsx)(Y.Z,{className:"w-4 h-4"}),layout:{editor:{width:60,height:50},output:{width:40,height:30},chat:{width:40,height:20},video:{width:40,height:50}},category:"workflow"},{id:"desktop",name:"Desktop",description:"Optimized for large screens",icon:(0,s.jsx)(G.Z,{className:"w-4 h-4"}),layout:{editor:{width:70,height:60},output:{width:30,height:40},chat:{width:30,height:30},video:{width:30,height:30}},category:"device"},{id:"tablet",name:"Tablet",description:"Optimized for medium screens",icon:(0,s.jsx)(X.Z,{className:"w-4 h-4"}),layout:{editor:{width:75,height:65},output:{width:25,height:45},chat:{width:25,height:25},video:{width:25,height:30}},category:"device"},{id:"mobile",name:"Mobile",description:"Optimized for small screens",icon:(0,s.jsx)(K.Z,{className:"w-4 h-4"}),layout:{editor:{width:85,height:70},output:{width:15,height:50},chat:{width:15,height:25},video:{width:15,height:25}},category:"device"}];function et(e){let{currentLayout:t,onLayoutChange:a,onLoadPreset:i}=e,[n,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)("all"),d=e=>{a(e.layout),null==i||i(e),o(!1)},u=ee.filter(e=>"all"===l||e.category===l),m=[{id:"all",name:"All",count:ee.length},{id:"workflow",name:"Workflow",count:ee.filter(e=>"workflow"===e.category).length},{id:"device",name:"Device",count:ee.filter(e=>"device"===e.category).length}];return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(g.z,{variant:"outline",size:"sm",onClick:()=>o(!n),className:"bg-gray-800 border-gray-600 text-white hover:bg-gray-700",children:[(0,s.jsx)($.Z,{className:"w-4 h-4 mr-2"}),"Layout Presets",(0,s.jsx)(P.Z,{className:"w-4 h-4 ml-2 transition-transform duration-200 ".concat(n?"rotate-180":"")})]}),(0,s.jsx)(T.M,{children:n&&(0,s.jsxs)(R.E.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute top-full right-0 mt-2 w-80 bg-gray-800 border border-gray-600 rounded-lg shadow-xl z-50",children:[(0,s.jsx)("div",{className:"p-3 border-b border-gray-600",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-white",children:"Layout Presets"}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"Quick layout switching"})]})}),(0,s.jsx)("div",{className:"flex border-b border-gray-600",children:m.map(e=>(0,s.jsxs)("button",{onClick:()=>c(e.id),className:"flex-1 px-3 py-2 text-xs font-medium transition-colors duration-200 ".concat(l===e.id?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"),children:[e.name," (",e.count,")"]},e.id))}),(0,s.jsx)("div",{className:"max-h-64 overflow-y-auto",children:u.map(e=>(0,s.jsxs)("div",{className:"p-3 hover:bg-gray-700 transition-colors duration-150 cursor-pointer border-b border-gray-600 last:border-b-0",onClick:()=>d(e),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"text-blue-400",children:e.icon}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-white",children:e.name}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:e.description})]})]}),(0,s.jsxs)("div",{className:"mt-2 flex space-x-1",children:[(0,s.jsx)("div",{className:"h-2 bg-blue-500 rounded",style:{width:"".concat(e.layout.editor.width,"%")},title:"Editor: ".concat(e.layout.editor.width,"% \xd7 ").concat(e.layout.editor.height,"%")}),(0,s.jsx)("div",{className:"h-2 bg-green-500 rounded",style:{width:"".concat(e.layout.output.width,"%")},title:"Output: ".concat(e.layout.output.width,"% \xd7 ").concat(e.layout.output.height,"%")}),(0,s.jsx)("div",{className:"h-2 bg-purple-500 rounded",style:{width:"".concat(e.layout.chat.width,"%")},title:"Chat: ".concat(e.layout.chat.width,"% \xd7 ").concat(e.layout.chat.height,"%")}),(0,s.jsx)("div",{className:"h-2 bg-orange-500 rounded",style:{width:"".concat(e.layout.video.width,"%")},title:"Video: ".concat(e.layout.video.width,"% \xd7 ").concat(e.layout.video.height,"%")})]})]},e.id))})]})})]})}let ea=[{id:"javascript",name:"JavaScript",extension:"js",category:"basic",description:"Basic JavaScript function with console output",code:'// Welcome to CodeMitra JavaScript Editor!\n// This is a basic JavaScript template to get you started\n\nfunction greetUser(name) {\n  return `Hello, ${name}! Welcome to collaborative coding.`;\n}\n\n// Example usage\nconst userName = "Developer";\nconst message = greetUser(userName);\nconsole.log(message);\n\n// You can add more functions and logic here\nfunction calculateSum(a, b) {\n  return a + b;\n}\n\nconsole.log("Sum of 5 + 3 =", calculateSum(5, 3));\n\n// Try running this code to see the output!'},{id:"python",name:"Python",extension:"py",category:"basic",description:"Basic Python function with print output",code:'# Welcome to CodeMitra Python Editor!\n# This is a basic Python template to get you started\n\ndef greet_user(name):\n    return f"Hello, {name}! Welcome to collaborative coding."\n\n# Example usage\nuser_name = "Developer"\nmessage = greet_user(user_name)\nprint(message)\n\n# You can add more functions and logic here\ndef calculate_sum(a, b):\n    return a + b\n\nprint("Sum of 5 + 3 =", calculate_sum(5, 3))\n\n# List comprehension example\nnumbers = [1, 2, 3, 4, 5]\nsquares = [x**2 for x in numbers]\nprint("Squares:", squares)\n\n# Try running this code to see the output!'},{id:"java",name:"Java",extension:"java",category:"basic",description:"Basic Java class with main method",code:'// Welcome to CodeMitra Java Editor!\n// This is a basic Java template to get you started\n\npublic class Main {\n    public static void main(String[] args) {\n        System.out.println("Hello, Developer! Welcome to collaborative coding.");\n        \n        // Example method calls\n        String message = greetUser("Developer");\n        System.out.println(message);\n        \n        int result = calculateSum(5, 3);\n        System.out.println("Sum of 5 + 3 = " + result);\n        \n        // Array example\n        int[] numbers = {1, 2, 3, 4, 5};\n        System.out.println("Array elements:");\n        for (int num : numbers) {\n            System.out.print(num + " ");\n        }\n        System.out.println();\n    }\n    \n    public static String greetUser(String name) {\n        return "Hello, " + name + "! Welcome to collaborative coding.";\n    }\n    \n    public static int calculateSum(int a, int b) {\n        return a + b;\n    }\n}'},{id:"cpp",name:"C++",extension:"cpp",category:"basic",description:"Basic C++ program with main function",code:'// Welcome to CodeMitra C++ Editor!\n// This is a basic C++ template to get you started\n\n#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\n// Function declarations\nstring greetUser(string name);\nint calculateSum(int a, int b);\nvoid printArray(vector<int>& arr);\n\nint main() {\n    cout << "Hello, Developer! Welcome to collaborative coding." << endl;\n    \n    // Example method calls\n    string message = greetUser("Developer");\n    cout << message << endl;\n    \n    int result = calculateSum(5, 3);\n    cout << "Sum of 5 + 3 = " << result << endl;\n    \n    // Vector example\n    vector<int> numbers = {1, 2, 3, 4, 5};\n    cout << "Vector elements: ";\n    printArray(numbers);\n    \n    return 0;\n}\n\nstring greetUser(string name) {\n    return "Hello, " + name + "! Welcome to collaborative coding.";\n}\n\nint calculateSum(int a, int b) {\n    return a + b;\n}\n\nvoid printArray(vector<int>& arr) {\n    for (int num : arr) {\n        cout << num << " ";\n    }\n    cout << endl;\n}'}];function es(e){return ea.find(t=>t.id===e)||null}var er=a(6441),ei=a(7211);let en=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(er.fC,{ref:t,className:(0,ei.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...r})});en.displayName=er.fC.displayName;let eo=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(er.Ee,{ref:t,className:(0,ei.cn)("aspect-square h-full w-full",a),...r})});eo.displayName=er.Ee.displayName;let el=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(er.NY,{ref:t,className:(0,ei.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...r})});el.displayName=er.NY.displayName;var ec=a(6258),ed=a(6919),eu=a(7737);function em(e){let{}=e,{socket:t,isConnected:a}=(0,c.s)(),{user:i}=(0,n.aC)(),{currentRoom:l}=(0,o.N)(),[d,u]=(0,r.useState)([]),[m,h]=(0,r.useState)(""),[p,f]=(0,r.useState)([]),[y,b]=(0,r.useState)(!1),[v,D]=(0,r.useState)(!1),[j,N]=(0,r.useState)(!1),[w,C]=(0,r.useState)(!1),[k,E]=(0,r.useState)(""),[S,I]=(0,r.useState)("javascript"),[z,A]=(0,r.useState)(null),[L,Z]=(0,r.useState)(!1),[O,U]=(0,r.useState)(0),M=(0,r.useRef)(null),P=(0,r.useRef)();(0,r.useEffect)(()=>{var e;null===(e=M.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[d]),(0,r.useEffect)(()=>{if(t&&a&&l)return t.on("chat:message-received",e=>{let t={id:e.message.id,text:e.message.content,sender:{id:e.message.user.id,name:e.message.user.name,avatar:e.message.user.avatar},timestamp:new Date(e.message.createdAt),type:e.message.type||"text",status:"delivered"};u(e=>[...e,t])}),t.on("room:users",e=>{f(e.users.map(e=>({id:e.id,name:e.name,avatar:e.avatar,isOnline:!0,isTyping:!1})))}),t.on("chat:user-typing",e=>{f(t=>t.map(t=>t.id===e.userId?{...t,isTyping:!0}:t))}),t.on("chat:user-stopped-typing",e=>{f(t=>t.map(t=>t.id===e.userId?{...t,isTyping:!1}:t))}),t.on("chat:message-status",e=>{u(t=>t.map(t=>t.id===e.messageId?{...t,status:e.status}:t))}),t.on("chat:history",e=>{u(e.messages.map(e=>({id:e.id,text:e.content,sender:{id:e.user.id,name:e.user.name,avatar:e.user.avatar},timestamp:new Date(e.createdAt),type:e.type||"text",status:"delivered"})))}),t.on("chat:message-deleted",e=>{u(t=>t.filter(t=>t.id!==e.messageId))}),t.on("chat:message-edited",e=>{u(t=>t.map(t=>t.id===e.message.id?{...t,text:e.message.content}:t))}),t.emit("chat:get-history",{roomId:l.id}),()=>{t.off("chat:message-received"),t.off("room:users"),t.off("chat:user-typing"),t.off("chat:user-stopped-typing"),t.off("chat:message-status"),t.off("chat:history"),t.off("chat:message-deleted"),t.off("chat:message-edited")}},[t,a,l]);let B=()=>{if(!m.trim()||!t||!a||!l)return;let e={id:"temp-".concat(Date.now()),text:m.trim(),sender:{id:(null==i?void 0:i.id)||"",name:(null==i?void 0:i.name)||"Unknown",avatar:null==i?void 0:i.avatar},timestamp:new Date,type:"text",status:"sending"};u(t=>[...t,e]),h(""),t.emit("chat:send-message",{roomId:l.id,content:e.text,type:"text"}),P.current&&clearTimeout(P.current),t.emit("chat:typing-stop",{roomId:l.id}),b(!1)},V=e=>{h(e),t&&a&&l&&(y||(b(!0),t.emit("chat:typing-start",{roomId:l.id})),P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{b(!1),t.emit("chat:typing-stop",{roomId:l.id})},1e3))},_=async()=>{if(z&&t&&a&&l&&i)try{Z(!0),U(0);let e=Math.ceil(z.size/1048576);for(let t=0;t<e;t++){await new Promise(e=>setTimeout(e,100));let a=(t+1)/e*100;U(a)}let t="\uD83D\uDCCE ".concat(z.name);h(t),B(),A(null),N(!1),U(0)}catch(e){console.error("File upload failed:",e),alert("File upload failed")}finally{Z(!1)}},J=e=>{h(t=>t+e),D(!1)},W=e=>{switch(e){case"sending":return(0,s.jsx)("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"});case"sent":return(0,s.jsx)("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-blue-500 rounded-full"});case"delivered":return(0,s.jsx)("div",{className:"w-3 h-3 border-2 border-blue-500 rounded-full"});case"read":return(0,s.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full"});default:return null}},H=e=>e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:[(0,s.jsx)(T.M,{children:d.map(e=>(0,s.jsx)(R.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"flex ".concat(e.sender.id===(null==i?void 0:i.id)?"justify-end":"justify-start"),children:(0,s.jsx)("div",{className:"max-w-[80%] ".concat(e.sender.id===(null==i?void 0:i.id)?"order-2":"order-1"),children:(0,s.jsxs)("div",{className:"flex items-end space-x-2 ".concat(e.sender.id===(null==i?void 0:i.id)?"flex-row-reverse space-x-reverse":""),children:[e.sender.id!==(null==i?void 0:i.id)&&(0,s.jsxs)(en,{className:"w-6 h-6",children:[(0,s.jsx)(eo,{src:e.sender.avatar}),(0,s.jsx)(el,{className:"text-xs",children:e.sender.name.charAt(0).toUpperCase()})]}),(0,s.jsxs)("div",{className:"px-3 py-2 rounded-lg ".concat(e.sender.id===(null==i?void 0:i.id)?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100"),children:[e.sender.id!==(null==i?void 0:i.id)&&(0,s.jsx)("div",{className:"text-xs font-medium mb-1 opacity-75",children:e.sender.name}),"code"===e.type?(0,s.jsx)("pre",{className:"text-sm whitespace-pre-wrap font-mono",children:(0,s.jsx)("code",{children:e.text})}):(0,s.jsx)("div",{className:"text-sm",children:e.text}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-1 text-xs opacity-75 ".concat(e.sender.id===(null==i?void 0:i.id)?"text-blue-100":"text-gray-500"),children:[(0,s.jsx)("span",{children:H(e.timestamp)}),e.sender.id===(null==i?void 0:i.id)&&W(e.status)]})]})]})})},e.id))}),p.filter(e=>e.isTyping&&e.id!==(null==i?void 0:i.id)).map(e=>(0,s.jsx)(R.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex justify-start",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[(0,s.jsxs)(en,{className:"w-6 h-6",children:[(0,s.jsx)(eo,{src:e.avatar}),(0,s.jsx)(el,{className:"text-xs",children:e.name.charAt(0).toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex space-x-1",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,s.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,s.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})},e.id)),(0,s.jsx)("div",{ref:M})]}),w&&(0,s.jsxs)(R.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-gray-200 dark:border-gray-700 p-3 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)("select",{value:S,onChange:e=>I(e.target.value),className:"px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800",children:[(0,s.jsx)("option",{value:"javascript",children:"JavaScript"}),(0,s.jsx)("option",{value:"python",children:"Python"}),(0,s.jsx)("option",{value:"java",children:"Java"}),(0,s.jsx)("option",{value:"cpp",children:"C++"})]}),(0,s.jsx)(g.z,{size:"sm",onClick:()=>{k.trim()&&(h("```".concat(S,"\n").concat(k,"\n```")),B(),E(""),C(!1))},className:"px-3 py-1 text-xs",children:"Send Code"}),(0,s.jsx)(g.z,{size:"sm",variant:"outline",onClick:()=>C(!1),className:"px-3 py-1 text-xs",children:"Cancel"})]}),(0,s.jsx)("textarea",{value:k,onChange:e=>E(e.target.value),placeholder:"Enter your code here...",className:"w-full h-20 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 font-mono resize-none"})]}),(0,s.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 p-3",children:[(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),m.trim()&&B()},className:"flex items-center space-x-2",children:[(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)(x.I,{value:m,onChange:e=>{V(e.target.value)},placeholder:"Type a message...",className:"pr-20"}),(0,s.jsxs)("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center space-x-1",children:[(0,s.jsx)(g.z,{type:"button",size:"sm",variant:"ghost",onClick:()=>C(!w),className:"h-6 w-6 p-0 hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,s.jsx)(F.Z,{className:"w-3 h-3"})}),(0,s.jsx)(g.z,{type:"button",size:"sm",variant:"ghost",onClick:()=>N(!j),className:"h-6 w-6 p-0 hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,s.jsx)(ec.Z,{className:"w-3 h-3"})}),(0,s.jsx)(g.z,{type:"button",size:"sm",variant:"ghost",onClick:()=>D(!v),className:"h-6 w-6 p-0 hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,s.jsx)(ed.Z,{className:"w-3 h-3"})})]})]}),(0,s.jsx)(g.z,{type:"submit",size:"sm",disabled:!m.trim(),children:(0,s.jsx)(eu.Z,{className:"w-4 h-4"})})]}),j&&(0,s.jsx)("input",{type:"file",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){if(a.size>10485760){alert("File size must be less than 10MB");return}if(!["image/jpeg","image/png","image/gif","image/webp","text/plain","text/markdown","text/css","text/javascript","application/json","application/xml","application/pdf","video/mp4","video/webm","audio/mpeg","audio/wav"].includes(a.type)){alert("File type not supported");return}A(a),N(!0)}},className:"mt-2 w-full text-sm",accept:"image/*,.pdf,.doc,.docx,.txt,.js,.py,.java,.cpp"})]}),j&&z&&(0,s.jsx)(R.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>N(!1),children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Upload File"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-lg flex items-center justify-center",children:"\uD83D\uDCCE"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium truncate",children:z.name}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[(z.size/1024/1024).toFixed(2)," MB"]})]})]}),L&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Uploading..."}),(0,s.jsxs)("span",{children:[O.toFixed(0),"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(O,"%")}})})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(g.z,{onClick:_,disabled:L,className:"flex-1",children:L?"Uploading...":"Upload"}),(0,s.jsx)(g.z,{variant:"outline",onClick:()=>{N(!1),A(null)},children:"Cancel"})]})]})]})}),v&&(0,s.jsx)(R.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute bottom-full right-0 mb-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg p-3 z-10",children:(0,s.jsx)("div",{className:"grid grid-cols-8 gap-1 max-h-48 overflow-y-auto",children:["\uD83D\uDE00","\uD83D\uDE03","\uD83D\uDE04","\uD83D\uDE01","\uD83D\uDE06","\uD83D\uDE05","\uD83D\uDE02","\uD83E\uDD23","\uD83D\uDE0A","\uD83D\uDE07","\uD83D\uDE42","\uD83D\uDE43","\uD83D\uDE09","\uD83D\uDE0C","\uD83D\uDE0D","\uD83E\uDD70","\uD83D\uDE18","\uD83D\uDE17","\uD83D\uDE19","\uD83D\uDE1A","\uD83D\uDE0B","\uD83D\uDE1B","\uD83D\uDE1D","\uD83D\uDE1C","\uD83E\uDD2A","\uD83E\uDD28","\uD83E\uDDD0","\uD83E\uDD13","\uD83D\uDE0E","\uD83E\uDD29","\uD83E\uDD73","\uD83D\uDE0F","\uD83D\uDE12","\uD83D\uDE1E","\uD83D\uDE14","\uD83D\uDE1F","\uD83D\uDE15","\uD83D\uDE41","☹️","\uD83D\uDE23","\uD83D\uDE16","\uD83D\uDE2B","\uD83D\uDE29","\uD83E\uDD7A","\uD83D\uDE22","\uD83D\uDE2D","\uD83D\uDE24","\uD83D\uDE20","\uD83D\uDE21","\uD83E\uDD2C","\uD83E\uDD2F","\uD83D\uDE33","\uD83E\uDD75","\uD83E\uDD76","\uD83D\uDE31","\uD83D\uDE28","\uD83D\uDE30","\uD83D\uDE25","\uD83D\uDE13","\uD83E\uDD17","\uD83E\uDD14","\uD83E\uDD2D","\uD83E\uDD2B","\uD83E\uDD25","\uD83D\uDE36","\uD83D\uDE10","\uD83D\uDE11","\uD83D\uDE2F","\uD83D\uDE26","\uD83D\uDE27","\uD83D\uDE2E","\uD83D\uDE32","\uD83D\uDE34","\uD83E\uDD24","\uD83D\uDE2A","\uD83D\uDE35","\uD83E\uDD10","\uD83E\uDD74","\uD83E\uDD22","\uD83E\uDD2E","\uD83E\uDD27","\uD83D\uDE37","\uD83E\uDD12","\uD83E\uDD15","\uD83E\uDD11","\uD83E\uDD20","\uD83D\uDCA9","\uD83D\uDC7B","\uD83D\uDC7D","\uD83D\uDC7E","\uD83E\uDD16","\uD83D\uDE3A","\uD83D\uDE38","\uD83D\uDE39","\uD83D\uDE3B","\uD83D\uDE3C","\uD83D\uDE3D","\uD83D\uDE40","\uD83D\uDE3F","\uD83D\uDE3E","\uD83D\uDE48","\uD83D\uDE49","\uD83D\uDE4A","\uD83D\uDC8C","\uD83D\uDC98","\uD83D\uDC9D","\uD83D\uDC96","\uD83D\uDC97","\uD83D\uDC93","\uD83D\uDC9E","\uD83D\uDC95","\uD83D\uDC9F","❣️","\uD83D\uDC94","❤️","\uD83E\uDDE1","\uD83D\uDC9B","\uD83D\uDC9A","\uD83D\uDC99","\uD83D\uDC9C","\uD83D\uDDA4","\uD83D\uDCAF","\uD83D\uDCA2","\uD83D\uDCA5","\uD83D\uDCAB","\uD83D\uDCA6","\uD83D\uDCA8","\uD83D\uDD73️","\uD83D\uDCAC","\uD83D\uDDE8️","\uD83D\uDDEF️","\uD83D\uDCAD","\uD83D\uDCA4","\uD83C\uDF1F","✨","⭐"].map(e=>(0,s.jsx)("button",{onClick:()=>J(e),className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-700 rounded text-lg transition-colors",children:e},e))})})]})}var eh=a(4035),eg=a(20),ex=a(2212),ep=a(6810),ef=a(2780);function ey(){var e;let{socket:t,isConnected:a}=(0,c.s)(),{user:i}=(0,n.aC)(),{currentRoom:l}=(0,o.N)(),[d,u]=(0,r.useState)([]),[m,h]=(0,r.useState)(!0),[x,p]=(0,r.useState)(!0),[f,y]=(0,r.useState)(!1),[b,v]=(0,r.useState)(null),[D,j]=(0,r.useState)(null),N=(0,r.useRef)(null),w=(0,r.useRef)(new Map),C=(0,r.useRef)(null),k=(0,r.useCallback)(async()=>{try{let e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});v(e),C.current=e,N.current&&(N.current.srcObject=e),i&&u([{id:i.id,name:i.name,avatar:i.avatar,stream:e,isVideoOn:!0,isAudioOn:!0,isLocal:!0}])}catch(e){console.error("Failed to get user media:",e),j("Failed to access camera/microphone. Please check permissions.")}},[i]),E=(0,r.useCallback)(async()=>{if(t&&a&&l)try{await k(),y(!0),t.emit("video:join",{roomId:l.id}),t.emit("video:call-started",{roomId:l.id})}catch(e){console.error("Failed to start call:",e),j("Failed to start video call")}},[t,a,l,k]),S=(0,r.useCallback)(()=>{t&&a&&l&&(C.current&&(C.current.getTracks().forEach(e=>e.stop()),v(null),C.current=null),w.current.forEach(e=>e.close()),w.current.clear(),t.emit("video:leave",{roomId:l.id}),t.emit("video:call-ended",{roomId:l.id}),y(!1),u([]))},[t,a,l]),I=(0,r.useCallback)(()=>{if(C.current){let e=C.current.getVideoTracks()[0];e&&(e.enabled=!e.enabled,h(e.enabled),u(t=>t.map(t=>t.isLocal?{...t,isVideoOn:e.enabled}:t)))}},[]),z=(0,r.useCallback)(()=>{if(C.current){let e=C.current.getAudioTracks()[0];e&&(e.enabled=!e.enabled,p(e.enabled),u(t=>t.map(t=>t.isLocal?{...t,isAudioOn:e.enabled}:t)))}},[]);return(0,r.useEffect)(()=>{if(t&&a&&l)return t.on("video:incoming-call",e=>{console.log("Incoming call from:",e.from.name),E()}),t.on("video:user-joined",e=>{console.log("User joined video call:",e.userName);let a=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]});C.current&&C.current.getTracks().forEach(e=>{a.addTrack(e,C.current)}),a.onicecandidate=a=>{a.candidate&&t.emit("video:ice-candidate",{roomId:l.id,to:e.userId,candidate:a.candidate})},w.current.set(e.userId,a),u(t=>[...t,{id:e.userId,name:e.userName,avatar:e.userAvatar,isVideoOn:!0,isAudioOn:!0,isLocal:!1}])}),t.on("video:user-left",e=>{console.log("User left video call:",e.userId);let t=w.current.get(e.userId);t&&(t.close(),w.current.delete(e.userId)),u(t=>t.filter(t=>t.id!==e.userId))}),t.on("video:ice-candidate",e=>{let t=w.current.get(e.from);t&&t.addIceCandidate(new RTCIceCandidate(e.candidate))}),t.on("video:offer",async e=>{let a=w.current.get(e.from);if(a){await a.setRemoteDescription(new RTCSessionDescription(e.offer));let s=await a.createAnswer();await a.setLocalDescription(s),t.emit("video:answer",{roomId:l.id,to:e.from,answer:s})}}),t.on("video:answer",e=>{let t=w.current.get(e.from);t&&t.setRemoteDescription(new RTCSessionDescription(e.answer))}),w.current.forEach((e,t)=>{e.ontrack=e=>{u(a=>a.map(a=>a.id===t?{...a,stream:e.streams[0]}:a))}}),()=>{t.off("video:incoming-call"),t.off("video:user-joined"),t.off("video:user-left"),t.off("video:ice-candidate"),t.off("video:offer"),t.off("video:answer")}},[t,a,l,E]),(0,r.useEffect)(()=>()=>{C.current&&C.current.getTracks().forEach(e=>e.stop()),w.current.forEach(e=>e.close())},[]),(0,s.jsxs)("div",{className:"h-full bg-gray-900 flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border-b border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(Y.Z,{className:"w-5 h-5 text-blue-400"}),(0,s.jsx)("span",{className:"text-white font-medium",children:"Video Call"}),d.length>0&&(0,s.jsxs)("span",{className:"text-gray-400 text-sm",children:["(",d.length," participants)"]})]}),(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsxs)(g.z,{variant:"outline",size:"sm",onClick:f?S:E,className:f?"bg-red-600 border-red-500 text-white hover:bg-red-700":"bg-green-600 border-green-500 text-white hover:bg-green-700",children:[f?(0,s.jsx)(eh.Z,{className:"w-4 h-4 mr-2"}):(0,s.jsx)(eg.Z,{className:"w-4 h-4 mr-2"}),f?"End Call":"Start Call"]})})]}),D&&(0,s.jsx)("div",{className:"p-3 bg-red-900/20 border border-red-700 text-red-400 text-sm",children:D}),(0,s.jsx)("div",{className:"flex-1 p-3 overflow-auto",children:f?(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 h-full",children:[b&&(0,s.jsxs)("div",{className:"relative bg-gray-800 rounded-lg overflow-hidden",children:[(0,s.jsx)("video",{ref:N,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"}),(0,s.jsxs)("div",{className:"absolute bottom-2 left-2 bg-black/50 px-2 py-1 rounded text-white text-xs",children:[null==i?void 0:i.name," (You)"]}),!m&&(0,s.jsx)("div",{className:"absolute inset-0 bg-gray-800 flex items-center justify-center",children:(0,s.jsx)(en,{className:"w-16 h-16",children:(0,s.jsx)(el,{className:"text-2xl",children:(null==i?void 0:null===(e=i.name)||void 0===e?void 0:e.charAt(0))||"U"})})})]}),d.filter(e=>!e.isLocal).map(e=>{var t;return(0,s.jsxs)("div",{className:"relative bg-gray-800 rounded-lg overflow-hidden",children:[e.stream?(0,s.jsx)("video",{autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover",ref:t=>{t&&e.stream&&(t.srcObject=e.stream)}}):(0,s.jsx)("div",{className:"w-full h-full bg-gray-800 flex items-center justify-center",children:(0,s.jsx)(en,{className:"w-16 h-16",children:(0,s.jsx)(el,{className:"text-2xl",children:(null===(t=e.name)||void 0===t?void 0:t.charAt(0))||"U"})})}),(0,s.jsx)("div",{className:"absolute bottom-2 left-2 bg-black/50 px-2 py-1 rounded text-white text-xs",children:e.name})]},e.id)})]}):(0,s.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-center p-6",children:[(0,s.jsx)("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4",children:(0,s.jsx)(Y.Z,{className:"w-10 h-10 text-gray-400"})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"Start Video Call"}),(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-6",children:"Click the green button above to start a video call with other participants in this room."}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 text-gray-500 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(Y.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Video ON by default"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(ex.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Audio ON by default"})]})]})]})}),f&&(0,s.jsx)("div",{className:"p-3 border-t border-gray-700 bg-gray-800",children:(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,s.jsxs)(g.z,{variant:"outline",size:"sm",onClick:I,className:m?"bg-gray-700 border-gray-600 text-white":"bg-red-600 border-red-500 text-white",children:[m?(0,s.jsx)(Y.Z,{className:"w-4 h-4 mr-2"}):(0,s.jsx)(ep.Z,{className:"w-4 h-4 mr-2"}),m?"Video":"Video Off"]}),(0,s.jsxs)(g.z,{variant:"outline",size:"sm",onClick:z,className:x?"bg-gray-700 border-gray-600 text-white":"bg-red-600 border-red-500 text-white",children:[x?(0,s.jsx)(ex.Z,{className:"w-4 h-4 mr-2"}):(0,s.jsx)(ef.Z,{className:"w-4 h-4 mr-2"}),x?"Audio":"Audio Off"]}),(0,s.jsxs)(g.z,{variant:"outline",size:"sm",onClick:S,className:"bg-red-600 border-red-500 text-white hover:bg-red-700",children:[(0,s.jsx)(eh.Z,{className:"w-4 h-4 mr-2"}),"End Call"]})]})})]})}function eb(e){let{roomId:t,initialLanguage:a="javascript",initialCode:l="",onCodeChange:d,onLanguageChange:u}=e,{user:m}=(0,n.aC)(),{currentRoom:g,leaveRoom:x}=(0,o.N)(),{socket:p,isConnected:f}=(0,c.s)(),y=(0,i.useRouter)(),[b,v]=(0,r.useState)(l),[D,j]=(0,r.useState)(a),[N,w]=(0,r.useState)(!1),[C,k]=(0,r.useState)({editor:{width:70,height:60},output:{width:30,height:40},chat:{width:30,height:30},video:{width:30,height:30}});(0,r.useEffect)(()=>{if(!b.trim()||D!==a){let e=es(D);e&&(v(e.code),null==d||d(e.code))}},[D,b,d,a]);let E=(0,r.useCallback)(e=>{v(e),null==d||d(e),p&&f&&g&&p.emit("code:update",{roomId:g.id,code:e,language:D})},[p,f,g,D,d]);(0,r.useCallback)(e=>{j(e),null==u||u(e);let t=es(e);t&&(v(t.code),null==d||d(t.code)),p&&f&&g&&p.emit("code:language-change",{roomId:g.id,language:e})},[p,f,g,null==m?void 0:m.id,u,d]);let S=(0,r.useCallback)(()=>{w(!0),p&&f&&g&&p.emit("code:execute",{roomId:g.id,code:b,language:D,userId:null==m?void 0:m.id})},[p,f,g,null==m?void 0:m.id,D,b]),I=(0,r.useCallback)(()=>{S()},[S]);(0,r.useEffect)(()=>{if(!p||!f||!g)return;let e=e=>{e.userId!==(null==m?void 0:m.id)&&(v(e.code),null==d||d(e.code),e.language&&(j(e.language),null==u||u(e.language)))},t=e=>{e.userId!==(null==m?void 0:m.id)&&(j(e.language),null==u||u(e.language))},a=e=>{e.userId!==(null==m?void 0:m.id)&&console.log("User ".concat(e.userId," is executing ").concat(e.language," code"))},s=e=>{v(e.code),j(e.language),null==d||d(e.code),null==u||u(e.language)};return p.on("code:updated",e),p.on("code:language-changed",t),p.on("code:execution-started",a),p.on("room:code-sync",s),()=>{p.off("code:updated",e),p.off("code:language-changed",t),p.off("code:execution-started",a),p.off("room:code-sync",s)}},[p,f,g,null==m?void 0:m.id,d,u]),(0,r.useEffect)(()=>{p&&f&&g&&p.emit("room:join",{roomId:g.id})},[p,f,g]);let z=(0,r.useCallback)(async()=>{try{g&&p&&(p.emit("room:leave",{roomId:g.id}),await x(g.id)),y.push("/")}catch(e){console.error("Error leaving room:",e),y.push("/")}},[g,p,x,y]),T=(0,r.useCallback)(e=>{k(e),p&&f&&g&&p.emit("layoutChange",{roomId:g.id,layout:e,userId:null==m?void 0:m.id})},[p,f,g,null==m?void 0:m.id]),R=(0,r.useCallback)(e=>{console.log("Layout preset loaded:",e.name)},[]);return(0,s.jsxs)("div",{className:"h-screen bg-gray-900 flex flex-col collaborative-editor-layout",children:[(0,s.jsx)(B,{onRunCode:I,isExecuting:N,currentLanguage:D,onLeaveRoom:z}),(0,s.jsxs)("div",{className:"flex-1 overflow-hidden main-content-area",style:{marginTop:"4rem"},children:[" ",(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700 layout-controls",children:[(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsx)(et,{currentLayout:C,onLayoutChange:T,onLoadPreset:R})}),(0,s.jsx)("div",{className:"flex items-center space-x-2 text-sm text-gray-400",children:(0,s.jsx)("span",{children:"Drag borders to resize • Double-click to reset"})})]}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden resizable-layout-container",children:(0,s.jsx)(q,{onLayoutChange:T,initialLayout:C,children:{editor:(0,s.jsx)("div",{className:"h-full flex flex-col editor-container",children:(0,s.jsx)("div",{className:"flex-1 monaco-editor-container",style:{minHeight:"0"},children:(0,s.jsx)(h,{roomId:(null==g?void 0:g.id)||"",language:D,initialCode:b,onCodeChange:E})})}),output:(0,s.jsx)("div",{className:"h-full bg-gray-800 border-l border-gray-700",children:(0,s.jsx)(Z,{code:b,language:D,roomId:(null==g?void 0:g.id)||"",onExecutionStart:S,onExecutionComplete:()=>w(!1)})}),chat:(0,s.jsx)("div",{className:"h-full bg-gray-800 border-l border-gray-700",children:(0,s.jsx)(em,{roomId:(null==g?void 0:g.id)||""})}),video:(0,s.jsx)("div",{className:"h-full bg-gray-800 border-l border-gray-700",children:(0,s.jsx)(ey,{})})}})})]})]})}function ev(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),{user:a,isLoading:l}=(0,n.aC)(),{currentRoom:c,joinRoom:d,isLoading:u}=(0,o.N)(),[m,h]=(0,r.useState)(!1),[g,x]=(0,r.useState)(null),[p,f]=(0,r.useState)(""),[y,b]=(0,r.useState)("javascript"),v=e.roomId,D=(0,r.useCallback)(async()=>{if(a&&v)try{h(!0),x(null),await d(v,"",t);let e=es(y);e&&f(e.code)}catch(e){console.error("Failed to join room:",e),x(e instanceof Error?e.message:"Failed to join room")}finally{h(!1)}},[a,v,d,t,y]);(0,r.useEffect)(()=>{if(!l&&!a){t.push("/");return}a&&v&&!c&&D()},[a,l,v,c,t,D]),(0,r.useEffect)(()=>()=>{f(""),b("javascript")},[]);let j=(0,r.useCallback)(e=>{f(e)},[]),N=(0,r.useCallback)(e=>{b(e)},[]);return l||u?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,s.jsxs)("div",{className:"text-center space-y-4",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading collaborative environment..."})]})}):a?g?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-md w-full",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-red-600 mb-4",children:"Error Joining Room"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:g}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:D,disabled:m,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:m?"Joining...":"Retry"}),(0,s.jsx)("button",{onClick:()=>t.push("/dashboard"),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Back to Dashboard"})]})]})}):c&&c.id===v?(0,s.jsx)("div",{className:"h-screen",children:(0,s.jsx)(eb,{roomId:c.id,initialLanguage:y,initialCode:p,onCodeChange:j,onLanguageChange:N})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-md w-full",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Joining Room..."}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Attempting to join room..."}),(0,s.jsx)("button",{onClick:D,disabled:m,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:m?"Joining...":"Join Room"})]})}):null}},3842:function(e,t,a){"use strict";a.d(t,{z:function(){return i}});var s=a(7821);a(8078);var r=a(7211);function i(e){let{className:t,variant:a="default",size:i="md",isLoading:n=!1,children:o,disabled:l,...c}=e;return(0,s.jsxs)("button",{className:(0,r.cn)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{default:"bg-gray-900 text-white hover:bg-gray-800 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-200",primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-100 dark:hover:bg-gray-700",outline:"border border-gray-300 bg-transparent text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[a],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[i],t),disabled:l||n,...c,children:[n&&(0,s.jsx)("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),o]})}},8006:function(e,t,a){"use strict";a.d(t,{Ol:function(){return o},Zb:function(){return n},aY:function(){return c},ll:function(){return l}});var s=a(7821),r=a(8078),i=a(7211);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border border-gray-200 bg-white shadow-sm dark:border-gray-800 dark:bg-gray-900",a),...r})});n.displayName="Card";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...r})});o.displayName="CardHeader";let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h3",{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});l.displayName="CardTitle",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-gray-500 dark:text-gray-400",a),...r})}).displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",a),...r})});c.displayName="CardContent";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",a),...r})});d.displayName="CardFooter",d.displayName="CardFooter"},5231:function(e,t,a){"use strict";a.d(t,{I:function(){return n}});var s=a(7821),r=a(8078),i=a(7211);let n=r.forwardRef((e,t)=>{let{className:a,type:r,error:n,...o}=e;return(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:text-white dark:placeholder:text-gray-500",n&&"border-red-500 focus:ring-red-500",a),ref:t,...o}),n&&(0,s.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:n})]})});n.displayName="Input"},7211:function(e,t,a){"use strict";a.d(t,{cn:function(){return i}});var s=a(2605),r=a(1638);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}}},function(e){e.O(0,[659,93,660,443,877,597,115,364,744],function(){return e(e.s=6733)}),_N_E=e.O()}]);